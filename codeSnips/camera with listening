// Make cameraman hidden, invincible and move him around with the camera
// Only hide and attach the cameraman to the camera if indiCam is running on the server.



/* hideObjectGlobal
This command is designed for MP. Hides object on all connected clients as well as JIP. Call on the server only. Can be used on all objects with class names, i.e. (typeOf object != ""). In SP this command behaves just like hideObject.
*/



/* publicVariable
http://killzonekid.com/arma-scripting-tutorials-variables-part-3/
The good thing about this type of data exchange is that it is fast and reliable and you can attach public variable event handler addPublicVariableEventHandler to a variable and it will fire as soon as it detects that the value of the monitored variable changed. The bad thing is that being able to broadcast data from any computer to all computers on network can lead to exploits and hacking. At the time of writing there is an ongoing work in ArmA 3 to improve security.

There are 2 more quite useful public variable commands publicVariableClient and publicVariableServer. The difference with these two commands is that you can make a client talk only to the server and the server talk to a specific client. This can seriously reduce network traffic since instead of updating all computers on network you can only update selected ones.
*/




// This script will run code only on server machines to keep indiCam from requiring the mod server-side
if (isServer) then {

	// Tell all connecting clients that indiCam is running on the server
	// varspace setVariable [name, value, public]
	missionNameSpace setVariable ["indiCam_var_runningOnServer", true, true]; // The last part should sync for JIP as well.

};



// This is a client requesting the server to run a script
if (!isServer) then {

	_var = missionNameSpace getVariable ["indiCam_var_runningOnServer",-1];
	if (_var != -1) then {systemChat "indiCam is running on server";} else {systemChat "indiCam not running on server";};
	

	// Check if the server variable has been set and sent to this client
	// Stole this from https://forums.bohemia.net/forums/topic/189191-check-if-variable-exists-before-using-getvariable/
	if (isNil {missionNameSpace getVariable "indiCam_var_runningOnServer"}) then {
		systemChat "Another check: is Nil";
	} else {
		systemChat "Another check: it is something";
	};


	
	
	// I need to test remoteExec so that it works like I think below
	// Place the host and client in front of eachother and try to run [player,true] remoteExec ["hideObjectGlobal",2,true]; on the client
	// That should hide only the client and not all playersNumber
	// Otherwise I need to hide that specific player on every other machine using clientID or somesuch
	
	// Hide or unhide the cameraman
	indiCam_fnc_hideCameramanGlobal = {
		// Hide the player on every client and the server
		[player,true] remoteExec ["hideObjectGlobal",0,true]; // This works, but I would have wanted to use ownerID 2 (server) instead of 0
	};
	indiCam_fnc_showCameramanGlobal = {
		// Show the player on every client and the server
		[player,false] remoteExec ["hideObjectGlobal",0,true];
	};
	

	
	
	
};